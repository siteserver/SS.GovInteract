<!DOCTYPE html>
<html class="bg-white">

<head>
  <meta charset="utf-8" />
  <title>信件结果查询</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <script type="text/javascript" src="../../assets/lib/iframe-resizer-3.6.3/iframeResizer.contentWindow.min.js"></script>
</head>

<body class="p-0 bg-white">
  <link href="../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <link href="../../assets/css/siteserver.min.css" rel="stylesheet" type="text/css" />
  <div id="main" class="m-t-15 m-b-15 m-l-15 m-r-15">
    <template v-if="pageType === 'form'">
      <div v-if="isNoResult" class="text-center my-5">
        <img class="mt-3" src="../../assets/images/error.png" />
        <p class="lead mt-3 text-nowrap text-danger">未查询到指定条件的信件，请确保输入正确的查询条件！</p>
      </div>
      <form v-on:submit="btnSubmitClick">
        <p class="lead mt-3 text-nowrap">信件结果查询</p>
        <div class="form-group">
          <label> 姓名 <span class="text-danger">*</span>
          </label>
          <input v-model="name" :class="{'is-invalid': (isSubmit && !name) }" type="text" class="form-control form-control-sm" />
          <small v-if="(isSubmit && !name)" class="text-danger">姓名不能为空</small>
          <small v-else class="form-text text-muted">请在此输入您提交信件时填写的姓名</small>
        </div>
        <div class="form-group">
          <label> 查询码 <span class="text-danger">*</span>
          </label>
          <input v-model="queryCode" :class="{'is-invalid': (isSubmit && !queryCode) }" type="text" class="form-control form-control-sm">
          <small v-if="(isSubmit && !queryCode)" class="text-danger">查询码不能为空</small>
          <small v-else class="form-text text-muted">请在此输入您提交信件时返回的查询码</small>
        </div>
        <div class="text-center mt-3">
          <button type="button" @click="btnSubmitClick" class="btn btn-primary w-md mr-2">查 询</button>
        </div>
      </form>
    </template>
    <template v-else-if="pageType === 'success'">
      <p class="lead mt-3 text-nowrap">信件结果查询</p>
      <div class="row">
        <div class="col-md-12">
          <table class="table table-bordered bg-white">
            <tbody>
              <tr>
                <td class="text-center align-middle text-danger" rowspan="4">个<br>人<br>信<br>息</td>
                <td class="align-middle"> 姓名 </td>
                <td class="align-middle" colspan="3"> {{ dataInfo.name }} </td>
              </tr>
              <tr>
                <td class="align-middle" style="width:25%"> 性别 </td>
                <td class="align-middle" style="width:25%"> {{ dataInfo.gender }} </td>
                <td class="align-middle" style="width:25%">联系电话</td>
                <td class="align-middle" style="width:25%"> {{ dataInfo.phone }} </td>
              </tr>
              <tr>
                <td class="align-middle"> 电子邮箱</td>
                <td class="align-middle"> {{ dataInfo.email }} </td>
                <td class="align-middle"> 邮政编码 </td>
                <td class="align-middle"> {{ dataInfo.zip }} </td>
              </tr>
              <tr>
                <td class="align-middle"> 联系地址 </td>
                <td class="align-middle" colspan="3"> {{ dataInfo.address }} </td>
              </tr>
              <tr>
                <td class="text-center align-middle text-danger" rowspan="2"> 信<br> 件<br> 信<br> 息<br> </td>
                <td class="align-middle"> 信件标题 </td>
                <td class="align-middle" colspan="3"> {{ dataInfo.title }} </td>
              </tr>
              <tr>
                <td class="align-middle"> 信件内容 </td>
                <td class="align-middle" colspan="3"> {{ dataInfo.content }} </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <hr />
      <div class="form-horizontal" role="form">
        <div class="form-group row">
          <label class="col-2 col-form-label">信件状态</label>
          <label class="col-10 col-form-label" v-html="getStateText(dataInfo.isCompleted, dataInfo.state)"></label>
        </div>
        <div v-if="dataInfo.isCompleted && dataInfo.state == 'Denied' && dataInfo.denyReason" class="form-group row">
          <label class="col-2 col-form-label"> 拒绝理由 </label>
          <label class="col-10 col-form-label"> {{ dataInfo.denyReason }} </label>
        </div>
        <div v-if="dataInfo.isCompleted && dataInfo.replyContent" class="form-group row">
          <label class="col-2 col-form-label"> 答复内容 </label>
          <label class="col-10 col-form-label"> {{ dataInfo.replyContent }} </label>
        </div>
        <div v-if="dataInfo.isCompleted && fileInfoList && fileInfoList.length > 0" class="form-group row">
          <label class="col-2 col-form-label"> 答复附件 </label>
          <div class="row col-10 pt-2">
            <div class="col-sm-4 col-lg-3 col-xs-12" v-for="fileInfo in fileInfoList">
              <div class="card m-b-20">
                <div class="card-body">
                  <p class="card-text">{{ fileInfo.fileName }}</p>
                  <a :href="fileInfo.fileUrl" target="_blank" class="card-link">下 载</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div v-if="dataInfo.isCompleted && dataInfo.replyContent" class="form-group row">
          <label class="col-2 col-form-label"> 答复时间 </label>
          <label class="col-10 col-form-label"> {{ dataInfo.replyDate }} </label>
        </div>
      </div>
    </template>
    <template v-else>
      <div class="text-center my-5">
        <img class="mt-3" src="../../assets/images/loading.gif" />
        <p class="lead mt-3 text-nowrap">查询中，请稍后...</p>
      </div>
    </template>
  </div>
  <script src="../../assets/lib/vue-2.5.16.min.js" type="text/javascript"></script>
  <script src="../../assets/lib/es6-promise.auto.min.js"></script>
  <script src="../../assets/lib/axios-0.18.0.min.js"></script>
  <script src="../../assets/js/query.js" type="text/javascript"></script>
</body>

</html>